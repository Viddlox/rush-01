Valid inputs:
./rush_01 "4 3 2 1 1 2 2 2 4 3 2 1 1 2 2 2"
./rush_01 "4 3 2 1 1 2 2 2 4 3 2 1 1 2 2 2 1 1 1 1"
./rush_01 "4 3 2 1 1 2 2 2 4 3 2 1 1 2 2 2 1 1 1 1 2 2 2 2"
./rush_01 "4 3 2 1 1 2 2 2 4 3 2 1 1 2 2 2 1 1 1 1 2 2 2 2 3 3 3 3"
./rush_01 "4 3 2 1 1 2 2 2 4 3 2 1 1 2 2 2 1 1 1 1 2 2 2 2 3 3 3 3 4 4 4 4"
./rush_01 "4 3 2 1 1 2 2 2 4 3 2 1 1 2 2 2 1 1 1 1 2 2 2 2 3 3 3 3 4 4 4 4 5 5 5 5"


Invalid inputs:
./rush_01 "4321122243211222"
./rush_01 "43211222 43211222"
./rush_01 "43211222         "
./rush_01 "        431231231"

Heuristic tests:
4 x 4
./rush_01 "2 3 1 2 1 2 3 3 2 4 2 1 2 1 2 4"
./rush_01 "1 2 3 2 2 1 2 3 1 4 2 2 3 1 2 3"
./rush_01 "1 2 3 3 2 3 2 1 1 2 3 2 3 3 2 1"
./rush_01 "4 3 2 1 1 2 2 4 4 3 2 1 1 2 2 2"
./rush_01 "4 4 4 4 1 1 1 1 4 4 4 4 1 1 1 1"
./rush_01 "1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"
./rush_01 "4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4"
./rush_01 "3 3 2 1 2 1 3 3 4 2 1 2 1 2 4 2"

./rush_01 "4 3 2 2 1 2 3 3 1 2 2 3 3 2 1 2"


5 x 5
./rush_01 "2 2 1 2 3 1 2 3 4 3 2 4 3 2 1 2 2 1 2 5"
./rush_01 "3 2 2 1 2 2 4 1 3 2 3 2 1 4 2 2 3 5 1 2"
./rush_01 "3 1 2 2 4 3 2 4 2 1 2 2 1 2 3 3 2 4 2 1"

6 x 6
./rush_01 "1 4 3 3 2 2 3 1 2 2 3 4 1 3 3 3 2 2 3 1 2 3 2 4"
./rush_01 "2 3 2 3 3 1 4 2 3 1 2 3 3 1 2 2 5 3 1 3 3 2 2 2"
./rush_01 "3 1 5 2 2 2 3 4 1 2 2 4 2 3 3 1 2 2 3 1 2 4 2 3"
./rush_01 "3 2 2 3 1 4 1 3 3 2 3 2 3 2 3 3 6 1 2 3 2 2 1 3"

7 x 7
./rush_01 "5 1 4 4 3 2 2 1 2 2 2 2 3 4 2 6 3 3 3 2 1 3 1 2 2 3 3 4"
./rush_01 "7 3 2 2 3 1 2 1 2 2 3 4 3 5 4 6 3 2 3 2 1 2 1 2 3 2 5 4"